<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>삼국시대 건국 신화: 운명의 갈림길</title>
    <!-- Tailwind CSS 로드 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Noto Sans KR 폰트 로드 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Noto Sans KR 폰트를 기본 폰트로 설정 */
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        /* 선택지 버튼의 미세한 스타일 조정 */
        .choice-btn {
            transition: all 0.2s ease-in-out;
        }
        .choice-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="bg-gray-100">

    <div id="app" class="container mx-auto max-w-3xl p-4 sm:p-8 min-h-screen flex items-center justify-center">
        
        <main class="bg-white w-full rounded-xl shadow-2xl p-6 sm:p-10">
            
            <!-- 메인 타이틀 -->
            <header class="border-b-2 border-gray-200 pb-4 mb-6">
                <h1 class="text-3xl sm:text-4xl font-bold text-center text-gray-800">
                    삼국시대 건국 신화: 운명의 갈림길
                </h1>
                <p class="text-center text-gray-500 mt-2">
                    여러분의 선택이 영웅들의 운명을, 그리고 역사의 흐름을 바꿀 수도 있습니다.
                </p>
            </header>

            <!-- 내비게이션 버튼 -->
            <div id="nav-buttons" class="flex justify-between mb-4" style="display: none;">
                <button id="back-btn" class="px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-gray-700 transition-colors">&larr; 뒤로 가기</button>
                <button id="home-btn" class="px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white transition-colors">처음으로</button>
            </div>

            <!-- 장면 제목 -->
            <h2 id="scene-title" class="text-2xl font-bold text-blue-700 mb-4 transition-opacity duration-300"></h2>
            
            <!-- 이야기 내용 -->
            <div id="story-content" class="text-lg text-gray-700 leading-relaxed space-y-4 transition-opacity duration-300">
                <!-- JavaScript에 의해 내용이 채워집니다 -->
            </div>

            <!-- 선택지 버튼 -->
            <div id="choices-container" class="mt-8 space-y-3">
                <!-- JavaScript에 의해 버튼이 채워집니다 -->
            </div>

            <!-- 해설 박스 (필요시 보임) -->
            <div id="explanation-box" class="mt-8 border-l-4 border-yellow-400 bg-yellow-50 p-5 rounded-r-lg transition-all duration-300" style="display: none;">
                <!-- JavaScript에 의해 내용이 채워집니다 -->
            </div>

        </main>
    </div>

    <script>
        // 이야기 데이터
        const storyData = {
            'start': {
                title: '어느 나라의 이야기를 시작할까요?',
                text: '<p>플레이할 나라를 선택해주세요. 여러분의 선택이 새로운 역사를 만들지도 모릅니다.</p>',
                choices: [
                    { text: '1. 고구려 (주몽 편)', nextScene: '1-start' },
                    { text: '2. 신라 (박혁거세 편)', nextScene: '2-start' },
                    { text: '3. 백제 (온조 편)', nextScene: '3-start' }
                ]
            },
            '1-start': {
                title: '제1장: 북쪽의 아들, 주몽 (고구려)',
                text: `
                    <p>하늘의 신 해모수(혹은 부여의 왕 금와)와 물의 신 하백의 딸 유화 부인 사이에서 태어난 아이, 주몽. 그는 알에서 태어났으며, 어릴 적부터 활솜씨가 신기에 가까웠습니다.</p>
                    <p>부여의 금와왕은 주몽을 아들처럼 거두었지만, 금와왕의 일곱 아들은 주몽의 뛰어난 재능을 시기했습니다. "저 아이는 사람이 낳은 자가 아니니, 일찍 없애지 않으면 반드시 후환이 될 것입니다!"</p>
                    <p>왕자들은 매일 같이 주몽을 죽일 음모를 꾸몄습니다. 어느 날, 어머니 유화 부인이 주몽을 급히 불렀습니다.</p>
                    <p class="font-semibold text-gray-800">"아들아, 왕자들이 너를 해치려 한다. 이곳에 머무르다가는 목숨을 부지하기 어려울 것이야."</p>
                    <p>주몽은 깊은 고뇌에 빠졌습니다.</p>
                `,
                choices: [
                    { text: 'A. "어머니의 말씀이 옳습니다. 저를 따르는 이들과 함께 남쪽으로 떠나 새로운 나라를 세우겠습니다."', nextScene: '1-A' },
                    { text: 'B. "떠나는 것은 비겁합니다. 저를 아껴주신 금와왕께 왕자들의 잘못을 고하고, 정면으로 맞서 싸우겠습니다."', nextScene: '1-B' }
                ]
            },
            '1-A': {
                title: '제1장: [1-A] 남쪽으로의 탈출',
                text: `
                    <p>주몽은 자신을 따르는 오이, 마리, 협보 등과 함께 부여를 떠나 남쪽으로 향했습니다. 뒤에서는 금와왕의 군사들이 맹렬히 쫓아왔습니다. 마침내 그들 앞을 거센 엄천강이 가로막았습니다. 다리는 보이지 않고, 추격병의 함성 소리는 점점 가까워졌습니다.</p>
                    <p>절체절명의 순간, 주몽이 활을 들어 강물을 내리치며 외쳤습니다.<br><strong class="text-blue-600">"나는 천제의 아들이요, 하백의 외손이다! 나를 가로막는 강물아, 길을 열어라!"</strong></p>
                    <p>그러자 믿을 수 없는 일이 벌어졌습니다. 강물 속에서 수많은 자라와 물고기들이 떠올라 거대한 다리를 만들었습니다.</p>
                    <div class="my-4 p-6 bg-gray-100 rounded-lg text-center text-gray-600 italic">[이미지: 자라와 물고기가 만든 다리를 건너는 주몽 일행]</div>
                    <p>주몽과 일행이 강을 건너자, 자라와 물고기들은 흩어졌고, 추격병들은 더 이상 쫓아오지 못했습니다.</p>
                    <p>마침내 졸본 땅에 도착한 주몽은 그곳을 도읍으로 삼고 나라를 세웠으니, 이것이 바로 <strong>고구려</strong>의 시작이었습니다.</p>
                `,
                choices: [
                    { text: '다른 이야기 보기 (처음으로)', nextScene: 'start' }
                ]
            },
            '1-B': {
                title: '제1장: [1-B] 정면 돌파의 길',
                text: `
                    <p>주몽은 자신을 따르는 이들을 모아 왕자들과 대치했습니다. 궁궐 안에서 칼과 활이 부딪히는 소리가 울려 퍼졌고, 이 소란에 금와왕이 크게 노하여 나타났습니다.</p>
                    <p class="font-semibold text-gray-800">"이게 무슨 짓이냐! 형제끼리 칼을 겨누다니!"</p>
                    <p>왕자들이 일제히 주몽을 모함했지만, 주몽 역시 당당하게 외쳤습니다. "왕자들이 먼저 저를 죽이려 했습니다. 저는 스스로를 지켰을 뿐입니다!"</p>
                    <p>금와왕은 분노했지만, 한편으로는 주몽의 용기와 그를 따르는 무리들을 보며 두려움을 느꼈습니다.</p>
                    <p>"주몽, 너의 재능이 오히려 화를 불렀구나. 너를 부여에 둘 수는 없다." 금와왕은 주몽에게 약간의 무리와 말을 주며 부여의 서쪽 변방으로 떠날 것을 명했습니다.</p>
                `,
                explanation: `
                    <h4 class="font-bold text-yellow-800 mb-2">[해설: 만약 주몽이 남쪽이 아닌 서쪽으로 갔다면?]</h4>
                    <p class="text-yellow-700">(B) 선택지는 작가의 상상입니다. 실제 역사 기록과 신화 속에서 주몽은 자신을 따르는 세력과 함께 <strong>남쪽</strong>으로 향했습니다. 이는 당시 부여의 정치적 압박을 피해 새로운 근거지를 찾으려는 이주 세력의 모습을 반영합니다.</p>
                    <p class="text-yellow-700 mt-2"><strong>역사적 오개념 주의:</strong> 만약 주몽이 서쪽(현재의 몽골 고원이나 내몽골 지역)으로 갔다면, 그는 유목 민족들과의 경쟁에 휘말렸을 것이며, 농경과 유목의 접경지대인 졸본 지역에 고구려를 건국한 것과는 전혀 다른 역사가 펼쳐졌을 것입니다. 신화에서 '남쪽'이라는 방향은 새로운 땅, '하늘의 뜻'이 향하는 곳을 상징합니다.</p>
                `,
                choices: [
                    { text: '다른 이야기 보기 (처음으로)', nextScene: 'start' }
                ]
            },
            '2-start': {
                title: '제2장: 남쪽의 알, 혁거세 (신라)',
                text: `
                    <p>아주 먼 옛날, 한반도 동남쪽 진한 땅에는 6개의 작은 마을(6촌)이 있었습니다. 6촌의 촌장들은 어느 날 높은 산에 올라 마을을 내려다보며 걱정했습니다. "우리를 다스릴 어진 임금이 계시지 않으니 백성들이 흩어지고 있구나."</p>
                    <p>그때였습니다. 양산 기슭의 나정이라는 우물가에서 신비로운 자주색 기운이 뿜어져 나오는 것을 발견했습니다.</p>
                    <div class="my-4 p-6 bg-gray-100 rounded-lg text-center text-gray-600 italic">[이미지: 백마(白馬) 한 마리가 알을 향해 절을 하고 있는 모습]</div>
                    <p>그곳으로 달려가 보니, 웬 백마(白馬) 한 마리가 알을 향해 절을 하고 있었습니다. 말이 하늘로 날아가고, 그 자리에는 박처럼 생긴 커다란 알이 남아있었습니다. 6촌장들은 이 알이 하늘이 보낸 것이라 생각했습니다.</p>
                `,
                choices: [
                    { text: 'A. "하늘이 주신 아이니, 우리 6촌이 함께 왕으로 모시고 정성껏 키웁시다."', nextScene: '2-A' },
                    { text: 'B. "알을 처음 발견한 것은 나, 소벌도리요. 내가 이 아이를 거두어 내 아들로 삼겠소."', nextScene: '2-B' }
                ]
            },
            '2-A': {
                title: '제2장: [2-A] 6촌의 공동 왕',
                text: `
                    <p>알을 깨고 나온 아이는 용모가 훤칠하고 기품이 넘쳤습니다. 아이의 몸에서는 빛이 났고, 사람들은 그를 '박혁거세(朴赫居世)', 즉 '박처럼 생긴 알에서 나와 세상을 밝히는 왕'이라 불렀습니다.</p>
                    <p>같은 날, 알영이라는 우물에서는 용의 옆구리에서 태어난 아름다운 소녀, 알영이 나타났습니다.</p>
                    <p>6촌장들은 혁거세와 알영을 함께 길렀습니다. 두 아이가 13살이 되던 해, 6촌장들은 혁거세를 왕으로, 알영을 왕비로 추대했습니다. 나라 이름은 '서라벌'이라 하였으니, 이것이 바로 <strong>신라</strong>의 시작이었습니다.</p>
                `,
                choices: [
                    { text: '다른 이야기 보기 (처음으로)', nextScene: 'start' }
                ]
            },
            '2-B': {
                title: '제2장: [2-B] 숨겨진 아이',
                text: `
                    <p>소벌도리 촌장은 몰래 알을 가져와 자신의 집에서 깨웠습니다. 알에서 나온 아이는 영특했지만, 소벌도리는 아이의 신비한 탄생을 숨기고 자신의 아들로 키웠습니다.</p>
                    <p>아이는 '혁거세'라는 이름 대신 '박돌'이라는 평범한 이름으로 불리며 자랐습니다. 비록 한 마을 안에서는 가장 뛰어난 인물이었지만, 다른 5촌의 촌장들은 그의 존재를 몰랐습니다. 진한의 6촌은 여전히 하나로 합쳐지지 못하고 각자의 세력을 유지했습니다.</p>
                `,
                explanation: `
                    <h4 class="font-bold text-yellow-800 mb-2">[해설: 만약 6촌이 연합하지 않았다면?]</h4>
                    <p class="text-yellow-700">(B) 선택지는 작가의 상상입니다. 신라의 건국 신화에서 <strong>6촌장들이 '함께' 박혁거세를 왕으로 추대</strong>한 것은 매우 중요한 의미를 갖습니다.</p>
                    <p class="text-yellow-700 mt-2"><strong>역사적 오개념 주의:</strong> 이는 신라가 6개의 부족(6촌)이 연합하여 세운 '연맹 왕국'에서 출발했음을 상징합니다. 박혁거세는 이 6부족 연맹의 초대 왕이었던 것입니다. 만약 소벌도리 촌장이 혁거세를 독점했다면, 신라는 6부족의 연합이 아닌 하나의 작은 부족 국가로 시작했거나, 6촌 간의 분열로 인해 국가 자체가 성립되지 못했을 수도 있습니다.</p>
                `,
                choices: [
                    { text: '다른 이야기 보기 (처음으로)', nextScene: 'start' }
                ]
            },
            '3-start': {
                title: '제3장: 두 형제의 맹세, 온조 (백제)',
                text: `
                    <p>주몽이 고구려를 세울 때, 그를 도운 여걸 소서노가 있었습니다. 소서노에게는 비류와 온조라는 두 아들이 있었습니다. (이들이 주몽의 아들이라는 설도 있습니다.)</p>
                    <p>세월이 흘러, 주몽이 부여에 두고 온 첫째 아들 유리가 고구려로 찾아와 태자가 되었습니다. 소서노는 자신의 아들들이 고구려에서 설 자리가 없음을 깨달았습니다.</p>
                    <p class="font-semibold text-gray-800">"유리가 태자가 되었으니, 우리는 이곳에 머물 수 없다. 남쪽으로 내려가 새로운 나라를 세우자."</p>
                    <p>소서노와 비류, 온조는 자신들을 따르는 무리를 이끌고 남쪽으로 향했습니다. 마침내 한강 유역의 넓은 평야에 도착했습니다. 하지만 이곳에서 두 형제의 의견이 엇갈렸습니다.</p>
                `,
                choices: [
                    { text: 'A. 형 비류: "바닷가가 좋겠소. 저기 미추홀(인천) 땅은..." / 동생 온조: "아닙니다. 이곳 위례성 땅은..."', nextScene: '3-A' },
                    { text: 'B. "우리는 다시는 갈라설 수 없습니다. 두 곳의 장점을 모두 가진 땅을 찾을 때까지 함께합시다."', nextScene: '3-B' }
                ]
            },
            '3-A': {
                title: '제3장: [3-A] 갈라선 형제',
                text: `
                    <p>결국 형 비류는 자신을 따르는 무리를 이끌고 미추홀로 갔고, 동생 온조는 위례성에 자리를 잡았습니다.</p>
                    <p>온조가 세운 '십제(十濟)'는 날로 번창했습니다. 땅이 비옥하여 농사가 잘 되었고, 한강을 통해 교역하기도 좋았습니다.</p>
                    <p>하지만 비류가 정착한 미추홀은 땅이 습하고 물이 짜서 농사를 지을 수 없었습니다. 백성들은 굶주림에 지쳐갔고, 비류는 자신의 선택을 후회하며 괴로워하다 세상을 떠났습니다.</p>
                    <p>미추홀의 백성들은 모두 온조가 있는 위례성으로 돌아왔습니다. 온조는 그들을 모두 받아들였고, 나라 이름을 '백제(百濟)', 즉 '모든 백성이 즐겁게 따랐다'는 뜻으로 바꾸었습니다. 이것이 바로 <strong>백제</strong>의 시작이었습니다.</p>
                `,
                choices: [
                    { text: '다른 이야기 보기 (처음으로)', nextScene: 'start' }
                ]
            },
            '3-B': {
                title: '제3장: [3-B] 하나의 나라',
                text: `
                    <p>비류와 온조는 서로의 의견을 존중하며 더 나은 땅을 찾아 함께 헤맸습니다. 마침내 그들은 한강 유역이면서도 바다로 나아가기 쉬운 완벽한 장소를 찾았습니다.</p>
                    <p>두 형제는 힘을 합쳐 성을 쌓고 나라를 세웠습니다. 형제는 서로 의지하며 나라를 다스렸고, 나라는 처음부터 분열 없이 강력한 힘을 발휘하며 빠르게 성장했습니다.</p>
                `,
                explanation: `
                    <h4 class="font-bold text-yellow-800 mb-2">[해설: 만약 비류와 온조가 갈등하지 않았다면?]</h4>
                    <p class="text-yellow-700">(B) 선택지는 작가의 상상입니다. 백제 건국 신화에서 <strong>비류와 온조의 분리와 재통합</strong> 과정은 중요한 의미를 지닙니다.</p>
                    <p class="text-yellow-700 mt-2"><strong>역사적 오개념 주의:</strong> 이는 고구려에서 내려온 이주 세력이 정착지를 찾는 과정에서 겪었던 내부 갈등(비류파 vs 온조파)과 그 극복 과정을 상징적으로 보여줍니다. 비류의 실패(미추홀)와 온조의 성공(위례성)은, 초기 백제가 해안 지대보다는 농경에 유리한 한강 유역의 내륙에서 발전했음을 의미합니다. 결국 온조를 중심으로 세력이 통합되어 '백제'가 성립된 것입니다. 만약 처음부터 갈등이 없었다면 백제의 건국 과정은 더 순탄했을 수 있지만, 신화는 이러한 G갈등과 통합의 서사를 통해 국가 건국의 정당성을 강조합니다.</p>
                `,
                choices: [
                    { text: '다른 이야기 보기 (처음으로)', nextScene: 'start' }
                ]
            }
        };

        // DOM 요소 가져오기
        const sceneTitleEl = document.getElementById('scene-title');
        const storyContentEl = document.getElementById('story-content');
        const choicesContainerEl = document.getElementById('choices-container');
        const explanationBoxEl = document.getElementById('explanation-box');
        const navButtonsEl = document.getElementById('nav-buttons');
        const backBtn = document.getElementById('back-btn');
        const homeBtn = document.getElementById('home-btn');

        let currentSceneId = null;
        const sceneHistory = [];

        /**
         * 지정된 ID의 장면으로 이동하고 히스토리를 기록합니다.
         * @param {string} sceneId - 이동할 장면의 ID
         */
        function goToScene(sceneId) {
            if (currentSceneId) {
                sceneHistory.push(currentSceneId);
            }
            currentSceneId = sceneId;
            displayScene(sceneId);
        }

        /**
         * 이전 장면으로 돌아갑니다.
         */
        function goBack() {
            if (sceneHistory.length > 0) {
                const previousSceneId = sceneHistory.pop();
                currentSceneId = previousSceneId;
                displayScene(previousSceneId);
            }
        }

        /**
         * 처음(메인) 화면으로 돌아갑니다. 히스토리를 초기화합니다.
         */
        function goHome() {
            sceneHistory.length = 0; // 히스토리 초기화
            currentSceneId = 'start';
            displayScene('start');
        }

        /**
         * 지정된 ID의 장면을 화면에 렌더링합니다. (기존 renderScene 함수에서 이름 변경)
         * @param {string} sceneId - 렌더링할 장면의 ID
         */
        function displayScene(sceneId) { // 'renderScene'에서 'displayScene'으로 이름 변경
            const scene = storyData[sceneId];
            if (!scene) {
                console.error(`'${sceneId}'에 해당하는 장면을 찾을 수 없습니다.`);
                return;
            }

            // 페이드 아웃 효과를 위해 투명도 조절
            sceneTitleEl.style.opacity = 0;
            storyContentEl.style.opacity = 0;

            setTimeout(() => {
                // 1. 장면 제목 업데이트
                sceneTitleEl.innerHTML = scene.title;
                
                // 2. 이야기 내용 업데이트
                storyContentEl.innerHTML = scene.text;

                // 3. 선택지 버튼 업데이트 (기존 버튼 삭제)
                choicesContainerEl.innerHTML = '';
                if (scene.choices) {
                    scene.choices.forEach(choice => {
                        const button = document.createElement('button');
                        button.innerHTML = choice.text;
                        // Tailwind CSS 클래스와 커스텀 클래스 적용
                        button.className = 'choice-btn w-full text-left p-4 rounded-lg bg-gray-50 hover:bg-blue-100 border border-gray-200 hover:border-blue-300 transition-all duration-200 shadow-sm';
                        
                        // 클릭 이벤트 설정 (goToScene으로 변경)
                        button.onclick = () => goToScene(choice.nextScene);
                        
                        choicesContainerEl.appendChild(button);
                    });
                }

                // 4. 해설 박스 업데이트
                if (scene.explanation) {
                    explanationBoxEl.innerHTML = scene.explanation;
                    explanationBoxEl.style.display = 'block';
                } else {
                    explanationBoxEl.style.display = 'none';
                    explanationBoxEl.innerHTML = '';
                }

                // 5. 내비게이션 버튼 업데이트
                if (sceneId === 'start') {
                    navButtonsEl.style.display = 'none';
                } else {
                    navButtonsEl.style.display = 'flex';
                }

                // 뒤로 가기 버튼 활성화/비활성화
                if (sceneHistory.length === 0) {
                    backBtn.style.visibility = 'hidden';
                } else {
                    backBtn.style.visibility = 'visible';
                }

                // 페이드 인 효과
                sceneTitleEl.style.opacity = 1;
                storyContentEl.style.opacity = 1;

                // 페이지 상단으로 스크롤 (모바일에서 유용)
                window.scrollTo(0, 0);

            }, 300); // 300ms 지연 후 내용 변경
        }

        // 새롭게 추가된 내비게이션 버튼 이벤트 리스너
        backBtn.onclick = goBack;
        homeBtn.onclick = goHome;

        // 페이지 로드 시 첫 장면('start')을 렌더링합니다.
        document.addEventListener('DOMContentLoaded', () => {
            goToScene('start'); // renderScene 대신 goToScene 호출
        });

    </script>
</body>
</html>

